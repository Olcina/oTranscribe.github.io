function setFromTimestamp(a,b){ts.setFrom(a,b)}!function(){function a(a){if($("#audio").remove(),$("#player-hook").append('<audio id="audio" src=""></audio>'),window.webkitURL){console.log("webkit");var b=window.webkitURL.createObjectURL(a)}else var b=window.URL.createObjectURL(a);console.log(b),$("#audio")[0].src=b,console.log(a.name)}function b(){var a=!document.getElementById("audio").paused;1==a?(document.getElementById("audio").pause(),$(".play-pause").removeClass("playing")):(document.getElementById("audio").play(),$(".play-pause").addClass("playing"))}function c(a){var b=document.getElementById("audio");"forwards"==a?b.currentTime=b.currentTime+1.5:"backwards"==a&&(b.currentTime=b.currentTime-1.5)}function d(a){console.log(typeof a);var b,c=.5,d=2,e=.25,f=document.getElementById("audio").playbackRate;"up"==a&&d>f?b=f+e:"down"==a&&f>c?b=f-e:"reset"==a?b=1:"number"==typeof a&&(b=a),"undefined"!=typeof b&&(document.getElementById("audio").playbackRate=b,document.getElementById("slider3").value=b)}function e(){audiojs.events.ready(function(){audiojs.createAll()})}function f(){location.reload()}function g(){var a=$(".controls");console.log("Window width: "+$(window).width()+"\nControls offset: "+a.offset().left+"\nControls width: "+a.width()+"\nTitle width: "+$(".title").width());var b=$(window).width()-(a.offset().left+a.width()+$(".title").outerWidth());$(".scrubber").width($(".scrubber").width()+b),console.log(b)}function h(){$(".title").toggleClass("active"),$(".about").toggleClass("active")}function i(){$(".textbox-container").height(window.innerHeight-36)}function j(){var a=parseInt($("#textbox").offset().left,10)+700;$(".text-panel").css("left",a)}function k(a){var b,c=0,d=a.length;for(b=0;d>=b;b++)" "==a.charAt(b)&&c++;return c+1}function l(){var a=k(document.getElementById("textbox").innerHTML);document.getElementById("wc").innerHTML=a}function m(){setInterval(function(){l()},1e3)}function n(){var a=document.queryCommandState("Bold"),b=document.getElementById("icon-b"),c=document.queryCommandState("italic"),d=document.getElementById("icon-i");b.className=a===!0?"icon-bold active":"icon-bold",d.className=c===!0?"icon-italic active":"icon-italic"}function o(){setInterval(function(){n()},100)}function p(){var a=document.getElementById("textbox");localStorage.getItem("autosave")&&(a.innerHTML=localStorage.getItem("autosave")),setInterval(function(){localStorage.setItem("autosave",a.innerHTML)},1e3)}function q(){localStorage.getItem("lastfile")&&(document.getElementById("lastfile").innerHTML="Last file: "+localStorage.getItem("lastfile"),h())}function r(){var a=$(".file-input-wrapper")[0];a.addEventListener("dragover",function(){$(".file-input-wrapper").addClass("hover")},!1),a.addEventListener("dragleave",function(){$(".file-input-wrapper").removeClass("hover")},!1)}function s(a){var b=document.createElement("audio");return!(!b.canPlayType||!b.canPlayType("audio/"+a+";").replace(/no/,""))}function t(){var a=[],b=["mp3","ogg","webm","wav"],c=0;return b.forEach(function(b){1==s(b)&&(a[c]=b,c++)}),a.join(", ")}function u(a){var b=document.createElement("audio");return!(!b.canPlayType||!b.canPlayType(a.type).replace(/no/,""))}function v(b){var c=b.files[0];if(u(c)===!0)a(c),e(),g(),w(),localStorage.setItem("lastfile",c.name),$(".scrubber .loaded").html(c.name),console.log("Loading complete.");else{var d="Your browser does not support "+c.type.split("/")[1]+' files. Switch to a different browser or <a href="http://media.io">convert your file</a> to another format.';$("#formats").html(d).addClass("warning")}}function w(){$(".topbar").toggleClass("inputting"),$(".input").toggleClass("active"),$(".sbutton.time").toggleClass("active"),$(".text-panel").toggleClass("editing")}function x(){document.getElementById("formats").innerHTML="Your browser supports the following formats: "+t()+". You may need to <a href='http://media.io'>convert your file</a>."}function y(){$(".start").html("Start transcribing").addClass("ready")}function z(){var a=!!document.createElement("audio").canPlayType,b=document.getElementById("textbox").contentEditable,c=!!window.FileReader;return a&&b&&c?!0:!1}function A(){z()===!1&&(document.getElementById("old-browser").innerHTML='Your browser does not appear to support some HTML5 features necessary for oTranscribe to run correctly. Please switch to a <a href="http://browsehappy.com">modern desktop browser</a>.')}function B(){A(),p(),q(),x(),i(),j(),r(),m(),o(),y()}function C(a){a.preventDefault?a.preventDefault():a.returnValue=!1}B(),$(window).resize(function(){i(),g(),j()}),Mousetrap.bind("escape",function(a){return C(a),b(),!1}),Mousetrap.bind("f1",function(a){return C(a),c("backwards"),!1}),Mousetrap.bind("f2",function(a){return C(a),c("forwards"),!1}),Mousetrap.bind("f3",function(a){return C(a),d("down"),!1}),Mousetrap.bind("f4",function(a){return C(a),d("up"),!1}),Mousetrap.bind("mod+j",function(a){return C(a),ts.insert(),!1}),Mousetrap.bind("mod+s",function(a){return C(a),alert("No need to manually save - your transcript is automatically backed up continuously."),!1}),Mousetrap.bind("mod+b",function(a){return C(a),document.execCommand("bold",!1,null),!1}),Mousetrap.bind("mod+i",function(a){return C(a),document.execCommand("italic",!1,null),!1}),$(".play-pause").click(function(){b()}),$(".skip-backwards").click(function(){c("backwards")}),$(".skip-forwards").click(function(){c("forwards")}),$(".speed").click(function(){$(".speed-box").not(":hover").length&&($(this).toggleClass("fixed"),console.log($(".speed-box").not(":hover").length))}),$(".button.refresh").click(function(){f()}),$("#slider3").change(function(){d(this.valueAsNumber)}),$(".title").click(function(){h()}),$(".about .start.ready").click(function(){h()}),$("#attach").change(function(){v(this)})}();var ts={split:function(a){var b=a.split(":"),c=60*+b[0]+ +b[1];return c},setFrom:function(a,b){console.log(b.childNodes.length),1==b.childNodes.length&&(document.getElementById("audio").currentTime=ts.split(a))},get:function(){var a=document.getElementById("audio").currentTime,b=Math.floor(a/60),c=("0"+Math.round(a-60*b)).slice(-2);return b+":"+c},insert:function(){document.execCommand("insertHTML",!1,'<span class="timestamp" contenteditable="false" onclick="var x = this; ts.setFrom(\''+ts.get()+"', x);\">"+ts.get()+"</span>&nbsp;"),$(".timestamp").each(function(){$(this)[0].contentEditable=!1})}};